<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VoteSmart</title>
    <script defer src="http://10.0.0.52:35729/livereload.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Outfit:wght@100;200;300;400;500;600;700;800;900&display=swap");
      /* Global styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Outfit", sans-serif;
        font-weight: 400;
        font-style: normal;
      }

    
      .container {
        max-width: 1800px;
        width: 100%;
        margin: 0 auto;
        padding: 0 20px;
      }

      .nav {
        position: relative;
        display: flex;
        align-items: center;
        padding: 20px 50px;
      }

      /* Logo on left */
      .logo {
        z-index: 1;
      }

      /* Add breathing room above the logo so it doesn't feel cramped */
      .logo {
        padding-top: 6px;
      }
      @media (max-width: 1024px) {
        .logo {
          padding-top: 8px;
        }
      }


.mobile-link:hover {
    background-position: 0;
}

/* Two subtle colored blobs behind the menu */
.mobile-menu::before,
.mobile-menu::after {
    content: '';
    position: absolute;
    z-index: -1;
    filter: blur(30px);
    opacity: 0.28;
    pointer-events: none;
}
.mobile-menu::before {
    width: 420px;
    height: 320px;
    right: -180px;
    top: -80px;
    background: radial-gradient(circle at 30% 30%, rgba(20,120,255,0.85), rgba(20,120,255,0.12) 50%, transparent 70%);
    transform: rotate(-12deg);
}
.mobile-menu::after {
    width: 380px;
    height: 330px;
    left: -130px;
    bottom: -80px;
    background: radial-gradient(circle at 60% 40%, rgba(10,200,150,0.82), rgba(10,200,150,0.12) 50%, transparent 70%);
    transform: rotate(12deg);
}
.mobile-link {
    position: relative;
    font-size: 16px;
    text-decoration: none;
    /* animated gradient like desktop links */
    background: linear-gradient(to right, #155ac2 50%, #333 50%);
    background-size: 200% 100%;
    background-position: 100%;
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    transition: background-position 0.5s ease;
    outline: none;
}
.mobile-cta {
    display: flex;
    gap: 10px;
    align-items: center;
    flex-direction: column; /* stack vertically */
}
.mobile-signup {
    padding: 12px 16px;
    font-size: 16px;
    background: linear-gradient(90deg,#0b3b7a,#155ac2);
    color: #fff;
    border-radius: 6px;
    border: none;
}

.ctaButton.mobile-signup {
    background: linear-gradient(90deg,#0b3b7a,#155ac2);
    color: #fff;
    border-radius: 6px;
    border: none;
}

/* Center menu and links, make menu 70% of viewport width */
@media (max-width: 800px) {
    .mobile-menu {
        left: 50%;
        right: auto;
        transform: translateX(-50%) translateY(-6px); /* keep slide translateY in closed state */
    width: 70vw;
    max-width: 420px;
    padding-top: 32px; /* increased top padding so first link isn't flush */
    }
    .mobile-menu.open {
        transform: translateX(-50%) translateY(0);
        
    }
    .mobile-menu {
        text-align: center;
    }
    .mobile-link {
        display: block;
        width: 100%;
        text-align: center;
        padding: 6px 0;
    }
    .mobile-link:first-of-type {
        margin-top: 6px; /* extra space above the first link */
    }
    .mobile-cta .mobile-link { /* ensure login link looks like a link in stack */
        padding: 8px 0;
    }
    .ctaButton.mobile-signup {
        width: 100%;
        padding: 18px 16px; /* slightly smaller */
        font-size: 14px;
    }
}

/* Divider between links and CTA */
.mobile-divider {
    height: 1px;
    background: rgba(0,0,0,0.06);
    margin: 6px 0 8px 0;
}

/* Responsive adjustments */
@media (max-width: 800px) {
    .links {
        display: none; /* hide center links on mobile */
    }
    .cta {
        display: none; /* hide right CTA on mobile (moved to mobile menu) */
    }
    .hamburger {
        display: inline-block;
        margin-left: auto;
    }
    .nav {
        padding: 16px 20px;
    }
}

      /* Logo text */
      .logoText {
        font-size: 42px;
        font-weight: 900;
        color: #0b1220;
        /* Make the logo appear thicker: subtle text-stroke (webkit) and layered shadows */
        -webkit-text-stroke: 0.6px rgba(11, 18, 32, 0.06);
        text-shadow: 0 1px 0 rgba(255, 255, 255, 0.02),
          0 2px 0 rgba(11, 18, 32, 0.02), 0 4px 8px rgba(11, 18, 32, 0.03);
        letter-spacing: -0.5px;
      }

      /* Links in center */
      .links {
        padding: 5px 24px;
        background-color: rgba(249, 249, 249, 0.6);

        border-radius: 8px;
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 25px;
        transition: gap 0.3s ease, font-size 0.3s ease; /* add smooth transitions */
      }

      @media (max-width: 1024px) {
        .nav {
          padding: 14px 20px;
          align-items: center;
        }
        .logoText {
          font-size: 32px;
        }
        .links {
          position: static;
          left: auto;
          transform: none;
          margin: 0 auto; /* keep it visually centered within available space */
          background-color: transparent;
          padding: 0 8px;
          gap: 18px;
          display: flex;
          justify-content: center;
          flex: 1 1 auto;
          white-space: nowrap;
          overflow: hidden;
        }
        .links .link {
          font-size: 16px;
          padding: 4px 6px;
          display: inline-block;
        }
        .cta {
          gap: 12px;
          margin-left: 8px;
          flex-shrink: 0; /* prevent CTA from shrinking */
          align-items: center;
        }
        .ctaButton {
          padding: 10px 18px;
          font-size: 14px;
        }
      }

      /* Hamburger button (hidden on desktop) */
      .hamburger {
        display: none; /* shown on small screens via media query */
        background: transparent;
        border: none;
        padding: 10px;
        margin-left: 16px;
        cursor: pointer;
        z-index: 30;
      }
      .hamburger-box {
        width: 24px;
        height: 18px;
        display: inline-block;
        position: relative;
      }
      .hamburger-inner,
      .hamburger-inner::before,
      .hamburger-inner::after {
        width: 24px;
        height: 2px;
        background-color: #333;
        position: absolute;
        left: 0;
        transition: transform 0.25s ease, opacity 0.2s ease;
      }
      .hamburger-inner {
        top: 50%;
        transform: translateY(-50%);
      }
      .hamburger-inner::before {
        content: "";
        top: -8px;
      }
      .hamburger-inner::after {
        content: "";
        top: 8px;
      }

      /* When hamburger is active (aria-expanded=true) transform into X */
      .hamburger[aria-expanded="true"] .hamburger-inner {
        transform: rotate(45deg);
      }
      .hamburger[aria-expanded="true"] .hamburger-inner::before {
        transform: rotate(90deg) translateX(0);
        top: 0;
      }
      .hamburger[aria-expanded="true"] .hamburger-inner::after {
        transform: rotate(90deg);
        opacity: 0;
      }

      @media (max-width: 900px) {
        .links {
          gap: 15px;
        }
        .links .link {
          font-size: 16px;
          transition: font-size 0.3s ease;
        }
      }
      /* Link styling */

      .link {
        position: relative;
        font-size: 19px;
        color: #333;
        text-decoration: none;
        background: linear-gradient(to right, #155ac2 50%, #333 50%);
        background-size: 200% 100%;
        background-position: 100%;
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        transition: background-position 0.5s ease;
      }

      .link:hover {
        background-position: 0;
      }

      .link::after {
        content: "";
        position: absolute;
        left: 0;
        bottom: -2px;
        height: 2px;
        width: 100%;
        background-color: #155ac2;
        transform: scaleX(0);
        transform-origin: left;
        transition: transform 0.3s ease;
      }

      .link:hover::after {
        transform: scaleX(1);
      }

      /* CTA section on right */
      .cta {
        margin-left: auto;
        display: flex;
        gap: 20px;
        align-items: center;
      }
      .ctaButton {
        padding: 12px 22px;
        background: linear-gradient(90deg, #0b3b7a 0%, #155ac2 100%);
        background-size: 200% 100%;
        color: white;
        border: none;
        font-size: 14px;
        border-radius: 5px;
        cursor: pointer;
        text-decoration: none;
        transition: background-position 0.5s ease, filter 0.3s ease,
          transform 0.1s ease;
      }

      .ctaButton:hover {
        background-position: right center;
        filter: brightness(1.1);
        transform: scale(1.05);
      }
      .ctaButton:active {
        transform: scale(0.95);
        filter: brightness(0.9);
      }

      /* Profile dropdown styles */
      .profile-dropdown {
        position: relative;
        display: inline-block;
      }

      .profile-button {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(21, 90, 194, 0.2);
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 14px;
        color: #333;
      }

      .profile-button:hover {
        background: rgba(21, 90, 194, 0.05);
        border-color: rgba(21, 90, 194, 0.3);
      }

      .profile-icon {
        width: 18px;
        height: 18px;
        color: #155ac2;
      }

      .profile-name {
        font-weight: 500;
        color: #333;
      }

      .dropdown-arrow {
        width: 14px;
        height: 14px;
        color: #666;
        transition: transform 0.3s ease;
      }

      .profile-dropdown.active .dropdown-arrow {
        transform: rotate(180deg);
      }

      .profile-menu {
        position: absolute;
        top: calc(100% + 8px);
        right: 0;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        padding: 8px 0;
        min-width: 180px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        opacity: 0;
        visibility: hidden;
        transform: translateY(-10px);
        transition: all 0.3s ease;
        z-index: 100;
      }

      .profile-dropdown.active .profile-menu {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      .profile-menu-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 16px;
        color: #333;
        text-decoration: none;
        font-size: 14px;
        transition: background-color 0.2s ease;
        border: none;
        background: none;
        width: 100%;
        text-align: left;
        cursor: pointer;
      }

      .profile-menu-item:hover {
        background-color: rgba(21, 90, 194, 0.05);
      }

      .menu-icon {
        width: 16px;
        height: 16px;
        color: #666;
      }

      .profile-divider {
        height: 1px;
        background: rgba(0, 0, 0, 0.1);
        margin: 8px 0;
      }

      .logout-form {
        margin: 0;
      }

      .logout-btn {
        color: #dc2626;
      }

      .logout-btn:hover {
        background-color: rgba(220, 38, 38, 0.05);
      }

      .logout-btn .menu-icon {
        color: #dc2626;
      }

      /* Mobile profile styles */
      .mobile-profile {
        display: flex;
        flex-direction: column;
        gap: 8px;
        align-items: center;
      }

      .mobile-profile-info {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 0;
        color: #333;
        font-weight: 500;
      }

      .mobile-profile-icon {
        width: 20px;
        height: 20px;
        color: #155ac2;
      }

      .mobile-profile-name {
        font-size: 16px;
      }

      .mobile-logout-form {
        margin: 8px 0 0 0;
        width: 100%;
      }

      .mobile-logout-btn {
        width: 100%;
        padding: 12px 16px;
        background: linear-gradient(90deg, #dc2626, #ef4444);
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        cursor: pointer;
        transition: background-position 0.3s ease;
      }

      .mobile-logout-btn:hover {
        background: linear-gradient(90deg, #b91c1c, #dc2626);
      }

      .mobile-menu {
        position: absolute;
        top: calc(100% + 8px);
        right: 20px;
        background: rgba(
          255,
          255,
          255,
          0.86
        ); /* slightly more transparent glass */
        backdrop-filter: blur(6px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        padding: 16px 16px;
        /* Use transform/opacity/max-height to animate open/close (class-based) */
        display: flex;
        flex-direction: column;
        gap: 12px;
        min-width: 180px;
        width: 240px; /* slightly smaller width */
        z-index: 20;
        overflow: hidden;
        max-height: 0; /* collapsed */
        opacity: 0;
        transform: translateY(-6px);
        pointer-events: none;
        transition: max-height 300ms ease, opacity 220ms ease,
          transform 250ms ease;
      }

      /* Open state — set by JS adding the `open` class */
      .mobile-menu.open {
        max-height: 520px; /* enough to contain items */
        opacity: 1;

        transform: translateY(0);
        pointer-events: auto;
      }

      /* Sticky navbar: target the whole <nav> element so background blends with hero */
      nav {
        position: sticky;
        top: 0;
        /* Default: transparent so animated background shows through */
        background: transparent;
        z-index: 50;
        backdrop-filter: none;
        -webkit-backdrop-filter: none;
        border-bottom: none;
        transition: transform 280ms ease, background-color 220ms ease,
          backdrop-filter 220ms ease;
      }

      /* Hide nav when scrolling down */
      .nav-hidden {
        transform: translateY(-120%);
        transition: transform 260ms ease;
      }

      /* Ensure nav transition is smooth when showing */
      nav {
        transition: transform 260ms ease;
      }

      /* Ensure nav content (links / icons) remains legible on darker hero backgrounds */
      nav .logoText,
      nav .link,
      nav .hamburger-inner,
      nav .hamburger-inner::before,
      nav .hamburger-inner::after {
        color: #0b1220; /* default dark text for contrast */
      }
      nav .ctaButton {
        color: #ffffff;
      }

      /* When nav should be shown (user scrolled up), apply the frosted background */
      nav.nav-visible {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(6px) saturate(1.05);
        -webkit-backdrop-filter: blur(6px) saturate(1.05);
        box-shadow: 0 1px 12px rgba(11, 18, 32, 0.06);
      }

      /* Hide nav by translating up */
      .nav-hidden {
        transform: translateY(-110%);
      }

.mobile-link:hover {
    background-position: 0;
}

/* Two subtle colored blobs behind the menu */
.mobile-menu::before,
.mobile-menu::after {
    content: '';
    position: absolute;
    z-index: -1;
    filter: blur(30px);
    opacity: 0.28;
    pointer-events: none;
}
.mobile-menu::before {
    width: 420px;
    height: 320px;
    right: -180px;
    top: -80px;
    background: radial-gradient(circle at 30% 30%, rgba(20,120,255,0.85), rgba(20,120,255,0.12) 50%, transparent 70%);
    transform: rotate(-12deg);
}
.mobile-menu::after {
    width: 380px;
    height: 330px;
    left: -130px;
    bottom: -80px;
    background: radial-gradient(circle at 60% 40%, rgba(10,200,150,0.82), rgba(10,200,150,0.12) 50%, transparent 70%);
    transform: rotate(12deg);
}
.mobile-link {
    position: relative;
    font-size: 16px;
    text-decoration: none;
    /* animated gradient like desktop links */
    background: linear-gradient(to right, #155ac2 50%, #333 50%);
    background-size: 200% 100%;
    background-position: 100%;
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    transition: background-position 0.5s ease;
    outline: none;
}
.mobile-cta {
    display: flex;
    gap: 10px;
    align-items: center;
    flex-direction: column; /* stack vertically */
}
.mobile-signup {
    padding: 12px 16px;
    font-size: 16px;
    background: linear-gradient(90deg,#0b3b7a,#155ac2);
    color: #fff;
    border-radius: 6px;
    border: none;
}

.ctaButton.mobile-signup {
    background: linear-gradient(90deg,#0b3b7a,#155ac2);
    color: #fff;
    border-radius: 6px;
    border: none;
}

/* Center menu and links, make menu 70% of viewport width */
@media (max-width: 800px) {
    .mobile-menu {
        left: 50%;
        right: auto;
        transform: translateX(-50%) translateY(-6px); /* keep slide translateY in closed state */
    width: 70vw;
    max-width: 420px;
    padding-top: 32px; /* increased top padding so first link isn't flush */
    }
    .mobile-menu.open {
        transform: translateX(-50%) translateY(0);
        
    }
    .mobile-menu {
        text-align: center;
    }
    .mobile-link {
        display: block;
        width: 100%;
        text-align: center;
        padding: 6px 0;
    }
    .mobile-link:first-of-type {
        margin-top: 6px; /* extra space above the first link */
    }
    .mobile-cta .mobile-link { /* ensure login link looks like a link in stack */
        padding: 8px 0;
    }
    .ctaButton.mobile-signup {
        width: 100%;
        padding: 18px 16px; /* slightly smaller */
        font-size: 14px;
    }
}

/* Divider between links and CTA */
.mobile-divider {
    height: 1px;
    background: rgba(0,0,0,0.06);
    margin: 6px 0 8px 0;
}

/* Responsive adjustments */
@media (max-width: 800px) {
    .links {
        display: none; /* hide center links on mobile */
    }
    .cta {
        display: none; /* hide right CTA on mobile (moved to mobile menu) */
    }
    .hamburger {
        display: inline-block;
        margin-left: auto;
    }
    .nav {
        padding: 16px 20px;
    }
}

    </style>
  </head>
  <body>
    <nav>
      <div class="container">
        <div class="nav">
          <div class="logo"><h1 class="logoText">VoteSmartt</h1></div>
          <button
            class="hamburger"
            aria-label="Toggle menu"
            aria-expanded="false"
            aria-controls="mobile-menu"
            onclick="console.log('clicked')"
          >
            <span class="hamburger-box">
              <span class="hamburger-inner"></span>
            </span>
          </button>
          <div class="links">
            <a href="/about" class="link">About</a>
            <a href="/credits" class="link">Credits</a>
            <a href="/contact" class="link">Contact</a>
          </div>
          <div class="cta">
            {% if logged_in %}
              <!-- Profile dropdown when logged in -->
              <div class="profile-dropdown">
                <button class="profile-button" onclick="toggleProfileDropdown()">
                  <i data-lucide="user" class="profile-icon"></i>
                  <span class="profile-name">{{first_name }}</span>
                  <i data-lucide="chevron-down" class="dropdown-arrow"></i>
                </button>
                <div class="profile-menu" id="profileMenu">
                  <a href="/profile" class="profile-menu-item">
                    <i data-lucide="user" class="menu-icon"></i>
                    Profile
                  </a>
                  <a href="/settings" class="profile-menu-item">
                    <i data-lucide="settings" class="menu-icon"></i>
                    Settings
                  </a>
                  <div class="profile-divider"></div>
                  <form action="/logout" method="post" class="logout-form">
                    <button type="submit" class="profile-menu-item logout-btn">
                      <i data-lucide="log-out" class="menu-icon"></i>
                      Logout
                    </button>
                  </form>
                </div>
              </div>
            {% else %}
              <!-- Login/Signup when not logged in -->
              <a href="/login" class="link">Log In</a>
              <a href="/register" class="ctaButton">Sign Up</a>
            {% endif %}
          </div>
          <div id="mobile-menu" class="mobile-menu" hidden>
            <a href="/about" class="mobile-link firstlink">About</a>
            <a href="/credits" class="mobile-link">Credits</a>
            <a href="/contact" class="mobile-link">Contact</a>
            <div class="mobile-divider" aria-hidden="true"></div>
            <div class="mobile-cta">
              {% if logged_in %}
                <!-- Mobile profile section when logged in -->
                <div class="mobile-profile">
                  <div class="mobile-profile-info">
                    <i data-lucide="user" class="mobile-profile-icon"></i>
                    <span class="mobile-profile-name">{{ first_name }}</span>
                  </div>
                  <a href="/profile" class="mobile-link">Profile</a>
                  <a href="/settings" class="mobile-link">Settings</a>
                  <form action="/logout" method="post" class="mobile-logout-form">
                    <button type="submit" class="mobile-logout-btn">Logout</button>
                  </form>
                </div>
              {% else %}
                <!-- Mobile login/signup when not logged in -->
                <a href="/login" class="mobile-link">Log In</a>
                <a href="/register" class="ctaButton mobile-signup">Sign Up</a>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </nav>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Hide nav while scrolling down, show on scroll up
        (function () {
          const nav = document.querySelector("nav");
          if (!nav) return;
          let lastScroll = window.scrollY;
          let ticking = false;
          const threshold = 1; // avoid micro-scroll jitter

          function onTick() {
            const current = window.scrollY;
            if (Math.abs(current - lastScroll) < threshold) {
              ticking = false;
              return;
            }

            if (current > lastScroll) {
              // Scrolling down: hide nav
              nav.classList.add("nav-hidden");
              nav.classList.remove("nav-visible");
            } else {
              // Scrolling up: show nav
              nav.classList.remove("nav-hidden");
              if (current > 10) {
                nav.classList.add("nav-visible");
              } else {
                nav.classList.remove("nav-visible");
              }
            }

            lastScroll = current;
            ticking = false;
          }

          window.addEventListener(
            "scroll",
            function () {
              if (!ticking) {
                window.requestAnimationFrame(onTick);
                ticking = true;
              }
            },
            { passive: true }
          );
        })();

        // ====== Mobile Menu (Hamburger) ======
        const hamburger = document.querySelector(".hamburger");
        const mobileMenu = document.getElementById("mobile-menu");

        if (!hamburger || !mobileMenu) return;

        // Ensure initial state is closed
        mobileMenu.hidden = true;
        hamburger.setAttribute("aria-expanded", "false");

        function openMenu() {
          mobileMenu.hidden = false;
          mobileMenu.classList.add("open");
          hamburger.setAttribute("aria-expanded", "true");
          document.documentElement.style.overflow = "hidden";
          lastFocused = document.activeElement;
          focusable[0] && focusable[0].focus();
          console.log("mobile menu opened");
        }

        function closeMenu() {
          mobileMenu.classList.remove("open");
          const transitionDuration = 300; // match CSS
          setTimeout(() => {
            mobileMenu.hidden = true;
          }, transitionDuration);
          hamburger.setAttribute("aria-expanded", "false");
          document.documentElement.style.overflow = "";
          if (lastFocused) lastFocused.focus();
          console.log("mobile menu closed");
        }

        hamburger.addEventListener("click", function () {
          const expanded = hamburger.getAttribute("aria-expanded") === "true";
          expanded ? closeMenu() : openMenu();
          console.log("hamburger clicked — expanded? ", !expanded);
        });

        // Close when clicking outside the menu
        document.addEventListener("click", function (e) {
          if (mobileMenu.hidden) return;
          if (hamburger.contains(e.target) || mobileMenu.contains(e.target))
            return;
          closeMenu();
        });

        // Close on Escape
        document.addEventListener("keydown", function (e) {
          if (e.key === "Escape" && !mobileMenu.hidden) {
            closeMenu();
            hamburger.focus();
          }

          // Focus trap inside the menu
          if (e.key === "Tab" && mobileMenu.classList.contains("open")) {
            if (focusable.length === 0) {
              e.preventDefault();
              return;
            }
            const currentIndex = focusable.indexOf(document.activeElement);
            if (e.shiftKey) {
              if (currentIndex === 0 || document.activeElement === mobileMenu) {
                focusable[focusable.length - 1].focus();
                e.preventDefault();
              }
            } else {
              if (currentIndex === focusable.length - 1) {
                focusable[0].focus();
                e.preventDefault();
              }
            }
          }
        });

        // Close when clicking a link in the menu
        mobileMenu.addEventListener("click", function (e) {
          const target = e.target.closest("a, button");
          if (target) closeMenu();
        });

        // Close menu when window resizes above breakpoint
        const MOBILE_BREAKPOINT = 800;
        window.addEventListener("resize", function () {
          if (window.innerWidth > MOBILE_BREAKPOINT && !mobileMenu.hidden) {
            closeMenu();
          }
        });

        // Focusable elements inside the mobile menu for focus trap
        let focusable = Array.from(
          mobileMenu.querySelectorAll(
            'a, button, [tabindex]:not([tabindex="-1"])'
          )
        );
        let lastFocused = null;

        const observer = new MutationObserver(() => {
          focusable = Array.from(
            mobileMenu.querySelectorAll(
              'a, button, [tabindex]:not([tabindex="-1"])'
            )
          );
        });
        observer.observe(mobileMenu, { childList: true, subtree: true });

        // ====== Profile Dropdown ======
        window.toggleProfileDropdown = function() {
          const dropdown = document.querySelector('.profile-dropdown');
          if (dropdown) {
            dropdown.classList.toggle('active');
          }
        };

        // Close profile dropdown when clicking outside
        document.addEventListener('click', function(e) {
          const dropdown = document.querySelector('.profile-dropdown');
          if (dropdown && !dropdown.contains(e.target)) {
            dropdown.classList.remove('active');
          }
        });

        // Initialize Lucide icons
        if (typeof lucide !== 'undefined') {
          lucide.createIcons();
        }
      });
    </script>
  </body>
</html>
