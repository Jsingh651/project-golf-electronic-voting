{% extends "base.html" %}

{% block title %}My Account â€” VoteSmart{% endblock %}

{% block extra_head %}
<script src="https://cdn.tailwindcss.com"></script>
<script>
    tailwind.config = {
        theme: {
            extend: {
                fontFamily: {
                    'inter': ['Inter', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'sans-serif'],
                },
                colors: {
                    'corporate-slate': {
                        800: '#1e293b',
                        600: '#334155',
                        500: '#64748b',
                        400: '#94a3b8',
                        300: '#cbd5e1',
                        200: '#e2e8f0',
                        100: '#f1f5f9',
                        50: '#f8fafc',
                    }
                }
            }
        }
    }
</script>
<style>
    body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    
    .bg-pattern {
        background-image: 
            radial-gradient(circle at 25% 25%, rgba(59, 130, 246, 0.02) 0%, transparent 25%),
            radial-gradient(circle at 75% 75%, rgba(16, 185, 129, 0.02) 0%, transparent 25%);
    }
    
    .verified-shield {
        animation: glowPulse 2s ease-in-out infinite;
    }
    
    @keyframes glowPulse {
        0%, 100% {
            filter: drop-shadow(0 0 4px rgba(34, 197, 94, 0.4));
            color: #22c55e;
        }
        50% {
            filter: drop-shadow(0 0 8px rgba(34, 197, 94, 0.8));
            color: #16a34a;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="bg-pattern fixed inset-0 -z-10"></div>

<div class="max-w-6xl mx-auto px-8 py-8 relative z-10 bg-corporate-slate-50 text-corporate-slate-800">
    <!-- Profile Header -->
    <div class="bg-white rounded-2xl p-10 mb-8 shadow-sm border border-corporate-slate-200">
        <div class="flex items-center gap-8 lg:flex-row flex-col lg:text-left text-center">
            <div class="w-32 h-32 rounded-full bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center text-5xl font-bold text-white shadow-lg shadow-blue-600/20 flex-shrink-0">
                {{ first_name[0] if first_name else 'U' }}{{ last_name[0] if last_name else '' }}
            </div>
            <div class="flex-1">
                <h1 class="text-3xl lg:text-4xl font-bold text-corporate-slate-800 mb-2">{{ first_name }} {{ last_name }}</h1>
                <div class="flex items-center gap-8 flex-wrap lg:justify-start justify-center">
                    <div class="flex items-center gap-2 text-corporate-slate-500 text-sm">
                        <i data-lucide="calendar" class="w-4 h-4 text-corporate-slate-400"></i>
                        <span>Joined {{ created_at.strftime('%B %Y') if created_at else 'Recently' }}</span>
                    </div>
                    <div class="flex items-center gap-2 text-corporate-slate-500 text-sm">
                        <i data-lucide="shield-check" class="w-4 h-4 text-green-500 verified-shield"></i>
                        <span>Verified Account</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="flex items-center px-5 py-4 rounded-lg mb-6 text-sm font-medium {{ 'bg-green-50 border border-green-200 text-green-800' if category == 'success' else 'bg-red-50 border border-red-200 text-red-800' }}">
                    <i data-lucide="{{ 'check-circle' if category == 'success' else 'alert-circle' }}" class="w-5 h-5 mr-3"></i>
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <!-- Account Tabs -->
    <div class="bg-white rounded-2xl shadow-sm border border-corporate-slate-200 overflow-hidden mb-8">
        <nav class="flex border-b border-corporate-slate-200 bg-corporate-slate-50">
            <button class="flex-1 py-4 px-6 bg-white text-blue-600 font-medium cursor-pointer transition-all duration-200 flex items-center justify-center gap-2 text-sm border-b-3 border-blue-600 tab-button active" data-tab="overview">
                <i data-lucide="user" class="w-5 h-5"></i>
                <span>Overview</span>
            </button>
            <button class="flex-1 py-4 px-6 bg-none border-none text-corporate-slate-500 font-medium cursor-pointer transition-all duration-200 flex items-center justify-center gap-2 text-sm border-b-3 border-transparent hover:text-blue-600 hover:bg-corporate-slate-100 tab-button" data-tab="settings">
                <i data-lucide="settings" class="w-5 h-5"></i>
                <span>Settings</span>
            </button>
            <button class="flex-1 py-4 px-6 bg-none border-none text-corporate-slate-500 font-medium cursor-pointer transition-all duration-200 flex items-center justify-center gap-2 text-sm border-b-3 border-transparent hover:text-blue-600 hover:bg-corporate-slate-100 tab-button" data-tab="security">
                <i data-lucide="shield" class="w-5 h-5"></i>
                <span>Security</span>
            </button>
        </nav>

        <!-- Overview Tab -->
        <div id="overview" class="tab-content active block p-10">
            <!-- Quick Actions -->
            <div class="bg-corporate-slate-50 rounded-xl p-6 mb-8 border border-corporate-slate-200">
                <h3 class="text-base font-semibold text-corporate-slate-800 mb-4">Quick Actions</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <a href="/events" class="flex items-center gap-3 p-4 bg-white border border-corporate-slate-200 rounded-lg text-corporate-slate-500 no-underline font-medium transition-all duration-200 text-sm hover:text-blue-600 hover:border-blue-600 hover:shadow-sm">
                        <i data-lucide="calendar" class="w-5 h-5"></i>
                        <span>View Events</span>
                    </a>
                    <a href="/contact" class="flex items-center gap-3 p-4 bg-white border border-corporate-slate-200 rounded-lg text-corporate-slate-500 no-underline font-medium transition-all duration-200 text-sm hover:text-blue-600 hover:border-blue-600 hover:shadow-sm">
                        <i data-lucide="help-circle" class="w-5 h-5"></i>
                        <span>Get Help</span>
                    </a>
                </div>
            </div>

            <!-- Voting Dashboard -->
            <div class="flex items-center gap-2 text-xl font-semibold text-corporate-slate-800 mb-6">
                <i data-lucide="bar-chart-3" class="w-5 h-5 text-blue-600"></i>
                Voting Dashboard
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-xl p-6 text-center border border-corporate-slate-200 transition-all duration-200 hover:border-corporate-slate-300 hover:shadow-md">
                    <div class="text-3xl font-bold text-blue-600 mb-2">{{ user_stats.total_votes if user_stats and user_stats.total_votes else 'N/A' }}</div>
                    <div class="text-sm text-corporate-slate-500 font-medium">Total Votes Cast</div>
                </div>
                <div class="bg-white rounded-xl p-6 text-center border border-corporate-slate-200 transition-all duration-200 hover:border-corporate-slate-300 hover:shadow-md">
                    <div class="text-3xl font-bold text-blue-600 mb-2">{{ user_stats.participation_rate if user_stats and user_stats.participation_rate else 'N/A' }}%</div>
                    <div class="text-sm text-corporate-slate-500 font-medium">Participation Rate</div>
                </div>
                <div class="bg-white rounded-xl p-6 text-center border border-corporate-slate-200 transition-all duration-200 hover:border-corporate-slate-300 hover:shadow-md">
                    <div class="text-3xl font-bold text-blue-600 mb-2">{{ user_stats.events_participated if user_stats and user_stats.events_participated else 'N/A' }}</div>
                    <div class="text-sm text-corporate-slate-500 font-medium">Events Participated</div>
                </div>
                <div class="bg-white rounded-xl p-6 text-center border border-corporate-slate-200 transition-all duration-200 hover:border-corporate-slate-300 hover:shadow-md">
                    <div class="text-3xl font-bold text-blue-600 mb-2">{{ user_stats.last_vote_date if user_stats and user_stats.last_vote_date else 'N/A' }}</div>
                    <div class="text-sm text-corporate-slate-500 font-medium">Last Vote</div>
                </div>
            </div>

            <!-- Recent Voting Activity -->
            <div class="flex items-center gap-2 text-xl font-semibold text-corporate-slate-800 mb-6">
                <i data-lucide="activity" class="w-5 h-5 text-blue-600"></i>
                Recent Voting Activity
            </div>
            {% if recent_votes and recent_votes|length > 0 %}
                <div class="grid gap-6 mb-8">
                    {% for vote in recent_votes[:3] %}
                    <div class="bg-corporate-slate-50 border border-corporate-slate-200 rounded-xl p-6 transition-all duration-200 hover:bg-corporate-slate-100 hover:border-corporate-slate-300">
                        <div class="flex justify-between items-start mb-4">
                            <div class="font-semibold text-corporate-slate-800">{{ vote.event_name }}</div>
                            <div class="text-sm text-corporate-slate-500">{{ vote.date.strftime('%B %d, %Y') if vote.date else 'N/A' }}</div>
                        </div>
                        <div class="flex gap-4 items-center">
                            <span class="px-3 py-1 rounded-full text-xs font-medium bg-green-50 text-green-800">{{ vote.status.title() if vote.status else 'N/A' }}</span>
                            <span class="text-sm text-corporate-slate-500">{{ vote.vote_type if vote.vote_type else 'General Election' }}</span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-center py-12 bg-white rounded-xl border-2 border-dashed border-corporate-slate-200">
                    <i data-lucide="vote" class="w-12 h-12 text-corporate-slate-400 mx-auto mb-4"></i>
                    <div class="text-xl font-semibold text-corporate-slate-800 mb-2">No Voting History</div>
                    <div class="text-corporate-slate-500 mb-6 leading-relaxed">You haven't participated in any elections yet. Check out upcoming events to get started!</div>
                    <a href="/events" class="inline-flex items-center gap-2 bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 hover:bg-blue-700">
                        <i data-lucide="calendar" class="w-4 h-4"></i>
                        View Upcoming Events
                    </a>
                </div>
            {% endif %}

            <!-- Voting Guides -->
            <div class="flex items-center gap-2 text-xl font-semibold text-corporate-slate-800 mb-6 mt-8">
                <i data-lucide="book-open" class="w-5 h-5 text-blue-600"></i>
                Voting Guides & Resources
            </div>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-white rounded-xl p-6 border border-corporate-slate-200 transition-all duration-200 hover:border-blue-600 hover:shadow-md">
                    <div class="flex items-center gap-3 mb-4">
                        <i data-lucide="calendar-check" class="w-6 h-6 text-blue-600"></i>
                        <div class="text-lg font-semibold text-corporate-slate-800">Upcoming Elections</div>
                    </div>
                    <div class="mb-4">
                        {% if upcoming_elections and upcoming_elections|length > 0 %}
                            {% for election in upcoming_elections[:2] %}
                            <div class="py-3 border-b border-corporate-slate-100 last:border-b-0">
                                <div class="font-medium text-corporate-slate-800 mb-1 text-sm">{{ election.title }}</div>
                                <div class="text-xs text-corporate-slate-500">{{ election.date.strftime('%B %d, %Y') if election.date else 'Date TBD' }}</div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="py-3">
                                <div class="font-medium text-corporate-slate-800 mb-1 text-sm">No upcoming elections</div>
                                <div class="text-xs text-corporate-slate-500">Check back later for updates</div>
                            </div>
                        {% endif %}
                    </div>
                    <a href="/events" class="inline-flex items-center text-blue-600 font-medium text-sm transition-colors duration-200 hover:text-blue-700">View All Events â†’</a>
                </div>

                <div class="bg-white rounded-xl p-6 border border-corporate-slate-200 transition-all duration-200 hover:border-blue-600 hover:shadow-md">
                    <div class="flex items-center gap-3 mb-4">
                        <i data-lucide="users" class="w-6 h-6 text-blue-600"></i>
                        <div class="text-lg font-semibold text-corporate-slate-800">Civic Resources</div>
                    </div>
                    <div class="mb-4">
                        <div class="py-3 border-b border-corporate-slate-100">
                            <div class="font-medium text-corporate-slate-800 mb-1 text-sm">How to Vote</div>
                            <div class="text-xs text-corporate-slate-500">Step-by-step voting guide</div>
                        </div>
                        <div class="py-3">
                            <div class="font-medium text-corporate-slate-800 mb-1 text-sm">Voting Rights</div>
                            <div class="text-xs text-corporate-slate-500">Know your rights and responsibilities</div>
                        </div>
                    </div>
                    <a href="https://www.vote.gov" target="_blank" class="inline-flex items-center text-blue-600 font-medium text-sm transition-colors duration-200 hover:text-blue-700">Learn More â†’</a>
                </div>
            </div>

            <!-- Profile Information -->
            <div class="flex items-center gap-2 text-xl font-semibold text-corporate-slate-800 mb-6 mt-8">
                <i data-lucide="user" class="w-5 h-5 text-blue-600"></i>
                Profile Information
            </div>
            <div class="bg-corporate-slate-50 border border-corporate-slate-200 rounded-xl p-6">
                <div class="grid sm:grid-cols-2 gap-4">
                    <div class="py-4 border-b border-corporate-slate-100 last:border-b-0">
                        <div class="text-xs font-medium text-corporate-slate-500 uppercase tracking-wide mb-1">Full Name</div>
                        <div class="text-base text-corporate-slate-800 font-medium">{{ first_name }} {{ last_name }}</div>
                    </div>
                    <div class="py-4 border-b border-corporate-slate-100 last:border-b-0">
                        <div class="text-xs font-medium text-corporate-slate-500 uppercase tracking-wide mb-1">Email Address</div>
                        <div class="text-base text-corporate-slate-800 font-medium">{{ email }}</div>
                    </div>
                    <div class="py-4 border-b border-corporate-slate-100 last:border-b-0">
                        <div class="text-xs font-medium text-corporate-slate-500 uppercase tracking-wide mb-1">Phone Number</div>
                        <div class="text-base text-corporate-slate-800 font-medium">{{ phone if phone else 'Not provided' }}</div>
                    </div>
                    <div class="py-4 border-b border-corporate-slate-100 last:border-b-0">
                        <div class="text-xs font-medium text-corporate-slate-500 uppercase tracking-wide mb-1">Account Status</div>
                        <div class="text-base text-corporate-slate-800 font-medium">Active Member</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab-content hidden p-10">
            <div class="flex items-center gap-2 text-xl font-semibold text-corporate-slate-800 mb-6">
                <i data-lucide="user" class="w-5 h-5 text-blue-600"></i>
                Personal Information
            </div>
            <form action="/update_profile" method="POST">
                <div class="grid gap-6 mb-8">
                    <div class="grid sm:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2" for="firstName">First Name</label>
                            <input type="text" id="firstName" name="first_name" class="w-full px-4 py-3.5 border border-gray-300 rounded-lg text-sm transition-all duration-200 bg-white focus:outline-none focus:border-blue-600 focus:ring-3 focus:ring-blue-100" value="{{ first_name }}" placeholder="Enter your first name" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2" for="lastName">Last Name</label>
                            <input type="text" id="lastName" name="last_name" class="w-full px-4 py-3.5 border border-gray-300 rounded-lg text-sm transition-all duration-200 bg-white focus:outline-none focus:border-blue-600 focus:ring-3 focus:ring-blue-100" value="{{ last_name }}" placeholder="Enter your last name" required>
                        </div>
                    </div>
                    <div class="grid sm:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2" for="email">Email Address</label>
                            <input type="email" id="email" name="email" class="w-full px-4 py-3.5 border border-gray-300 rounded-lg text-sm transition-all duration-200 bg-white focus:outline-none focus:border-blue-600 focus:ring-3 focus:ring-blue-100" value="{{ email }}" placeholder="Enter your email" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2" for="phone">Phone Number</label>
                            <input type="tel" id="phone" name="phone" class="w-full px-4 py-3.5 border border-gray-300 rounded-lg text-sm transition-all duration-200 bg-white focus:outline-none focus:border-blue-600 focus:ring-3 focus:ring-blue-100" value="{{ phone }}" placeholder="Enter your phone number">
                        </div>
                    </div>
                </div>

                <div class="flex justify-end gap-4 pt-6 border-t border-corporate-slate-200 mt-6">
                    <button type="button" class="inline-flex items-center gap-2 bg-corporate-slate-50 text-corporate-slate-500 border border-corporate-slate-200 font-medium py-3 px-6 rounded-lg text-sm transition-all duration-200 hover:bg-corporate-slate-100 hover:text-corporate-slate-600">
                        <i data-lucide="x" class="w-4 h-4"></i>
                        Cancel
                    </button>
                    <button type="submit" class="inline-flex items-center gap-2 bg-blue-600 text-white font-medium py-3 px-6 rounded-lg text-sm transition-all duration-200 hover:bg-blue-700">
                        <i data-lucide="save" class="w-4 h-4"></i>
                        Save Changes
                    </button>
                </div>
            </form>

            <div class="flex items-center gap-2 text-xl font-semibold text-corporate-slate-800 mb-6 mt-8">
                <i data-lucide="bell" class="w-5 h-5 text-blue-600"></i>
                Notification Preferences
            </div>
            <div class="bg-corporate-slate-50 border border-corporate-slate-200 rounded-xl p-6">
                <div>
                    <label class="flex items-center gap-3 text-sm font-medium text-gray-700">
                        <input type="checkbox" checked class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"> 
                        Email notifications for new events
                    </label>
                </div>
            </div>
        </div>

        <!-- Security Tab -->
        <div id="security" class="tab-content hidden p-10">
            <div class="flex items-center gap-2 text-xl font-semibold text-corporate-slate-800 mb-6">
                <i data-lucide="lock" class="w-5 h-5 text-blue-600"></i>
                Change Password
            </div>
            <form action="/change_password" method="POST">
                <div class="grid gap-6 mb-8">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2" for="currentPassword">Current Password</label>
                        <input type="password" id="currentPassword" name="current_password" class="w-full px-4 py-3.5 border border-gray-300 rounded-lg text-sm transition-all duration-200 bg-white focus:outline-none focus:border-blue-600 focus:ring-3 focus:ring-blue-100" placeholder="Enter your current password" required>
                    </div>
                    <div class="grid sm:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2" for="newPassword">New Password</label>
                            <input type="password" id="newPassword" name="new_password" class="w-full px-4 py-3.5 border border-gray-300 rounded-lg text-sm transition-all duration-200 bg-white focus:outline-none focus:border-blue-600 focus:ring-3 focus:ring-blue-100" placeholder="Enter your new password" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2" for="confirmPassword">Confirm New Password</label>
                            <input type="password" id="confirmPassword" name="confirm_password" class="w-full px-4 py-3.5 border border-gray-300 rounded-lg text-sm transition-all duration-200 bg-white focus:outline-none focus:border-blue-600 focus:ring-3 focus:ring-blue-100" placeholder="Confirm your new password" required>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end gap-4 pt-6 border-t border-corporate-slate-200 mt-6">
                    <button type="button" class="inline-flex items-center gap-2 bg-corporate-slate-50 text-corporate-slate-500 border border-corporate-slate-200 font-medium py-3 px-6 rounded-lg text-sm transition-all duration-200 hover:bg-corporate-slate-100 hover:text-corporate-slate-600">
                        <i data-lucide="x" class="w-4 h-4"></i>
                        Cancel
                    </button>
                    <button type="submit" class="inline-flex items-center gap-2 bg-blue-600 text-white font-medium py-3 px-6 rounded-lg text-sm transition-all duration-200 hover:bg-blue-700">
                        <i data-lucide="save" class="w-4 h-4"></i>
                        Update Password
                    </button>
                </div>
            </form>

            <div class="flex items-center gap-2 text-xl font-semibold text-corporate-slate-800 mb-6 mt-8">
                <i data-lucide="activity" class="w-5 h-5 text-blue-600"></i>
                Active Sessions
            </div>
            <div class="bg-corporate-slate-50 border border-corporate-slate-200 rounded-xl p-6">
                <div class="grid sm:grid-cols-2 gap-4">
                    <div class="py-4 border-b border-corporate-slate-100 last:border-b-0">
                        <div class="text-xs font-medium text-corporate-slate-500 uppercase tracking-wide mb-1">Current Session</div>
                        <div class="text-base text-corporate-slate-800 font-medium" id="current-session">Loading...</div>
                    </div>
                    <div class="py-4 border-b border-corporate-slate-100 last:border-b-0">
                        <div class="text-xs font-medium text-corporate-slate-500 uppercase tracking-wide mb-1">Last Login</div>
                        <div class="text-base text-corporate-slate-800 font-medium">{{ created_at.strftime('%B %d, %Y at %I:%M %p') if created_at else 'Unknown' }}</div>
                    </div>
                </div>
            </div>

            <div class="flex items-center gap-2 text-xl font-semibold text-corporate-slate-800 mb-6 mt-8">
                <i data-lucide="trash-2" class="w-5 h-5 text-red-600"></i>
                Danger Zone
            </div>
            <div class="flex items-center px-5 py-4 rounded-lg mb-6 text-sm font-medium bg-red-50 border border-red-200 text-red-800">
                <i data-lucide="alert-triangle" class="w-5 h-5 mr-3"></i>
                Once you delete your account, there is no going back. Please be certain.
            </div>

            <div class="flex justify-end">
                <button type="button" class="inline-flex items-center gap-2 bg-red-600 text-white font-medium py-3 px-6 rounded-lg text-sm transition-all duration-200 hover:bg-red-700">
                    <i data-lucide="trash-2" class="w-4 h-4"></i>
                    Delete Account
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    // Tab functionality
    document.addEventListener('DOMContentLoaded', function() {
        const tabButtons = document.querySelectorAll('.tab-button');
        
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const targetTab = button.getAttribute('data-tab');
                
                // Remove active class from all buttons and content
                tabButtons.forEach(btn => {
                    btn.classList.remove('active', 'bg-white', 'text-blue-600', 'border-blue-600');
                    btn.classList.add('text-corporate-slate-500', 'border-transparent');
                });
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active', 'block');
                    content.classList.add('hidden');
                });
                
                // Add active class to clicked button and corresponding content
                button.classList.add('active', 'bg-white', 'text-blue-600', 'border-blue-600');
                button.classList.remove('text-corporate-slate-500', 'border-transparent');
                document.getElementById(targetTab).classList.add('active', 'block');
                document.getElementById(targetTab).classList.remove('hidden');
            });
        });
    });

    // Get browser and OS information
    function getBrowserInfo() {
        const userAgent = navigator.userAgent;
        let browserName = "Unknown Browser";
        let osName = "Unknown OS";
        
        if (userAgent.includes("Chrome")) browserName = "Chrome";
        else if (userAgent.includes("Firefox")) browserName = "Firefox";
        else if (userAgent.includes("Safari")) browserName = "Safari";
        else if (userAgent.includes("Edge")) browserName = "Edge";
        
        if (userAgent.includes("Windows")) osName = "Windows";
        else if (userAgent.includes("Mac")) osName = "macOS";
        else if (userAgent.includes("Linux")) osName = "Linux";
        else if (userAgent.includes("Android")) osName = "Android";
        else if (userAgent.includes("iOS")) osName = "iOS";
        
        return `${browserName} on ${osName}`;
    }

    // Update current session info
    document.addEventListener('DOMContentLoaded', function() {
        const sessionElement = document.getElementById('current-session');
        if (sessionElement) {
            sessionElement.textContent = getBrowserInfo();
        }
    });
</script>
{% endblock %}